From 9b0bf2939561fb1e0ecb9b4ab8f894d24d125f82 Mon Sep 17 00:00:00 2001
From: Robert Marko <robimarko@gmail.com>
Date: Tue, 4 Apr 2023 11:17:31 +0200
Subject: [PATCH] SSDK: config: add kernel 6.3

Allow kernel 6.3 to be recognized and compiled under it.

Signed-off-by: Robert Marko <robimarko@gmail.com>
---
 config            | 6 +++++-
 make/linux_opt.mk | 4 ++--
 2 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/config b/config
index f807734f..444a2021 100755
--- a/config
+++ b/config
@@ -40,6 +40,10 @@ ifeq ($(KVER),$(filter 6.2%,$(KVER)))
 OS_VER=6_2
 endif
 
+ifeq ($(KVER),$(filter 6.4%,$(KVER)))
+OS_VER=6_4
+endif
+
 ifeq ($(KVER), 3.4.0)
 	OS_VER=3_4
 endif
@@ -148,7 +152,7 @@ ifeq ($(ARCH), arm)
 endif
 
 ifeq ($(ARCH), arm64)
-	ifeq ($(KVER),$(filter 4.1% 4.4% 4.9% 5.4% 5.10% 5.15% 6.1% 6.2%,$(KVER)))
+	ifeq ($(KVER),$(filter 4.1% 4.4% 4.9% 5.4% 5.10% 5.15% 6.1% 6.2% 6.4%,$(KVER)))
 		CPU_CFLAG=  -DMODULE -Os -pipe -march=armv8-a -mcpu=cortex-a53+crypto -fno-caller-saves -fno-strict-aliasing -fno-common -Wno-format-security -Wno-pointer-sign -Wno-unused-but-set-variable -Wno-error=unused-result -mcmodel=large
 	endif
 endif
diff --git a/make/linux_opt.mk b/make/linux_opt.mk
index 8fa2cd1b..f43b8a1c 100755
--- a/make/linux_opt.mk
+++ b/make/linux_opt.mk
@@ -437,7 +437,7 @@ ifeq (KSLIB, $(MODULE_TYPE))
       KASAN_SHADOW_SCALE_SHIFT := 3
   endif
 
-  ifeq ($(OS_VER),$(filter 5_4 5_10 5_15 6_1 6_2, $(OS_VER)))
+  ifeq ($(OS_VER),$(filter 5_4 5_10 5_15 6_1 6_2 6_4, $(OS_VER)))
       ifeq ($(ARCH), arm64)
           KASAN_OPTION += -DKASAN_SHADOW_SCALE_SHIFT=$(KASAN_SHADOW_SCALE_SHIFT)
        endif
@@ -468,7 +468,7 @@ ifeq (KSLIB, $(MODULE_TYPE))
 
   endif
 
-  ifeq ($(OS_VER),$(filter 4_4 5_4 5_10 5_15 6_1 6_2, $(OS_VER)))
+  ifeq ($(OS_VER),$(filter 4_4 5_4 5_10 5_15 6_1 6_2 6_4, $(OS_VER)))
                 MODULE_CFLAG += -DKVER34
                 MODULE_CFLAG += -DKVER32
             MODULE_CFLAG += -DLNX26_22
-- 
2.39.2

